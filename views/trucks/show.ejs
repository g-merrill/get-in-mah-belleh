<%- include('../partials/headerhtml') %>
<div class="truck-card-container">
    <p><%= truck.applicant.toUpperCase(); %></p>
    <!-- <p>Food offered: <%= truck.fooditems %></p> -->
    <% if (truck.reviews.length) { %>        
    <% for (let i = 0; i !== truckAvgRating; i++) { %>
    <span>&#9733</span>
    <% } %>
    <!-- how do I make this preview text? -->
    <p>
    <%= truck.reviews[truck.reviews.length - 1].content; %>
    </p>
    <!-- how do I make this preview text? -->
    <% } else { %>
    <span>&#9734</span>
    <span>&#9734</span>
    <span>&#9734</span>
    <span>&#9734</span>
    <span>&#9734</span>
    <p>
    No review submitted for this truck yet!
    </p>  
    <% } %>
    <% if (user) { %>
        <% if (!hasReviewed) { %>
    <p><i class="fas fa-pen"></i> Write a review</p>
        <% } else { %>
    <a href="/users/profile/trucks/<%= truck.id %>/reviews/<%= reviewId %>/edit">Edit Your Review</a>
        <% } %>
    <p><i class="fas fa-heart"></i> Save to favorites</p>
    <% } %>
</div>
<% if (user) { %>
    <% if (user.id === truck.creator.toString()) { %>
<a href="/users/profile/trucks/<%= truck.id %>/edit">Edit Food Truck Details</a>
<form action="/trucks/<%= truck.id %>?_method=DELETE" method="POST">
    <input type="submit" value="Delete Food Truck">
</form>
    <% } %>
    <% if (!hasReviewed) { %>
<a href="/users/profile/trucks/<%= truck.id %>/reviews/new">Add a Review</a>
    <% } %>
<% } %>
<h3>All Reviews: </h3>
<% if (reviews.length) { %>
    <!-- Stretch: could pop off the most recent review that is displaying up on the top card -->
    <% reviews.forEach(review => { %>
<div>
        <% for (let i = 0; i !== review.rating; i++) { %>
    <span>&#9733</span>
        <% } %>
</div>
<p><%= review.reviewer.name %> said: <%= review.content %></p>
    <% }); %>
<% } else { %>
<div>
    <span>&#9734</span>
    <span>&#9734</span>
    <span>&#9734</span>
    <span>&#9734</span>
    <span>&#9734</span>
</div>
<p>No reviews yet!</p>
<% } %>
<%- include('../partials/footerhtml') %>